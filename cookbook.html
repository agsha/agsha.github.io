<!doctype html>
<html lang="en" data-bs-theme="light">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Sharaths Core Dump - Cookbook</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="/theme/dracula.css" rel="stylesheet"/>

  </head>
  <body>
    <nav class="navbar border-bottom border-body">
      <ul class="nav">
        <li class="nav-item">
          <a class="nav-link active" href="/">Latest Articles</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/archives.html">Archive</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="pages/about.html">About</a>
        </li>
        <li class="nav-item">
          <div class="dropdown">
            <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
              Dark Mode
            </button>
            <ul class="dropdown-menu">
              <li class="dropdown-item" data-bs-theme-value="dark">dark</li>
              <li class="dropdown-item" data-bs-theme-value="light">light</li>
              <li class="dropdown-item" data-bs-theme-value="auto">auto</li>
            </ul>
          </div>
        </li>

      </ul>
    </nav>
    <div class="container">
      <h1><a href="/cookbook.html">Cookbook</a></h1>
      <small class="text-body-secondary">Mon, 31 Aug 2020</small>
      <p>This article captures cookbooks or recipes that I don't use frequently enough to remember, but still use it enough to be painful to google from scratch every time I use it. Its a bunch of totally unrelated stuff that is too short to put as a blog article on its own. Hopefully, you'll find the table of contexts helpful to navigate.
(the links are not working yet :( )</p>
<h1><a name="table-of-contents" href="#table-of-contents">Table of contents</a></h1>
<!-- toc -->
<ul>
<li><a href="#table-of-contents">Table of contents</a></li>
<li><a href="#julia-arrays">Julia Arrays</a></li>
<li><a href="#anaconda-dont-start-at-shell">Anaconda dont start at shell</a></li>
<li><a href="#how-to-mount-samba-folder-in-ubuntu">How to mount samba folder in ubuntu</a></li>
<li><a href="#how-to-use-du-to-search-for-hidden-folders">How to use du to search for hidden folders</a></li>
<li><a href="#sublime-text-keyboard-shortcuts">Sublime text keyboard shortcuts</a></li>
<li><a href="#making-nomachine-nx-work-on-amazon-aws-ec2">Making Nomachine nx work on amazon aws ec2</a></li>
<li><a href="#remote-desktop-to-raspberry-pi">Remote desktop to raspberry pi</a></li>
<li><a href="#echo-server-with-netcat">Echo server with netcat </a></li>
<li><a href="#mounting-a-disk-on-gcp">Mounting a disk on GCP</a></li>
<li><a href="#describe-type-of-command">Describe type of command</a></li>
<li><a href="#linux-networking">Linux Networking</a></li>
<li><a href="#postgres">Postgres</a></li>
<li><a href="#intellij-shortcuts">Intellij Shortcuts</a></li>
<li><a href="#bash-shortcuts">Bash shortcuts</a></li>
<li><a href="#how-to-setup-a-new-linux-machine">How to setup a new linux machine</a></li>
<li><a href="#python-regex-recipes">Python regex recipes </a></li>
<li><a href="#vim-one-liners-and-shortcuts">Vim one liners and shortcuts</a></li>
<li><a href="#cscope-for-linux">Cscope for linux </a></li>
<li><a href="#cscope-for-ceph">Cscope for ceph</a></li>
<li><a href="#building-linux">Building linux</a></li>
<li><a href="#using-ftrace-to-trace-linux-functions">Using Ftrace to trace linux functions</a></li>
<li><a href="#how-to-build-linux-on-one-machine-and-deploy-on-another">How to build linux on one machine and deploy on another</a></li>
<li><a href="#jemalloc">JeMalloc </a></li>
<li><a href="#objdump">Objdump</a></li>
<li><a href="#installing-latest-version-of-cmake">Installing latest version of cmake</a></li>
<li><a href="#getting-honest-profiler-to-work">Getting honest profiler to work</a></li>
<li><a href="#gcc-important-options">GCC important options</a></li>
<li><a href="#eli-bendersky-static-linking-summary">Eli bendersky static linking summary</a></li>
<li><a href="#eli-bendersky-load-time-linking-summary">Eli bendersky load time linking summary</a></li>
<li><a href="#eli-bendersky-x32-pic-linking-summary">Eli bendersky x32 PIC linking summary</a></li>
<li><a href="#linux-interrupt-handling">Linux Interrupt Handling</a></li>
<li><a href="#hdfs-proxy-user-setting">HDFS proxy user setting</a></li>
<li><a href="#http-proxy-with-squid">Http proxy with squid</a></li>
<li><a href="#kafka-metrics">kafka metrics</a></li>
</ul>
<!-- tocstop -->

<h1><a name="julia-arrays" href="#julia-arrays">Julia Arrays</a></h1>
<ul>
<li>tabs or spaces: concat to the right</li>
<li>semicolon or newline: concat to the bottom </li>
<li>one dimensional arrays are considered as column vectors for concatenation purposes</li>
</ul>
<h1><a name="anaconda-dont-start-at-shell" href="#anaconda-dont-start-at-shell">Anaconda dont start at shell</a></h1>
<p>If you'd prefer that conda's base environment not be activated on startup, </p>
<div class="highlight"><pre><span></span><code>conda<span class="w"> </span>config<span class="w"> </span>--set<span class="w"> </span>auto_activate_base<span class="w"> </span><span class="nb">false</span>
</code></pre></div>

<h1><a name="how-to-mount-samba-folder-in-ubuntu" href="#how-to-mount-samba-folder-in-ubuntu">How to mount samba folder in ubuntu</a></h1>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>mount<span class="w"> </span>-t<span class="w"> </span>cifs<span class="w"> </span>-o<span class="w"> </span><span class="nv">user</span><span class="o">=</span>sharath<span class="w"> </span>//192.168.29.28/HOMEPI<span class="w"> </span>/mnt/pi
</code></pre></div>

<h1><a name="how-to-use-du-to-search-for-hidden-folders" href="#how-to-use-du-to-search-for-hidden-folders">How to use du to search for hidden folders</a></h1>
<div class="highlight"><pre><span></span><code>du<span class="w"> </span>-schx<span class="w"> </span>.<span class="o">[</span>!.<span class="o">]</span>*<span class="w"> </span>*
</code></pre></div>

<p>To exclude other mount points use <code>--exclude</code></p>
<h1><a name="sublime-text-keyboard-shortcuts" href="#sublime-text-keyboard-shortcuts">Sublime text keyboard shortcuts</a></h1>
<p>Open any file <code>ctrl-p</code>
Open any command <code>ctrl-shift-p</code>
Close tab: mac <code>cmd+w</code>
Linux <code>ctrl-shift-w</code>
Jump back <code>alt -</code> 
forward <code>alt +</code> </p>
<h1><a name="making-nomachine-nx-work-on-amazon-aws-ec2" href="#making-nomachine-nx-work-on-amazon-aws-ec2">Making Nomachine nx work on amazon aws ec2</a></h1>
<p>First, download the nx package from nomachine and <code>dpkg -i</code> the package
The software is installed in <code>/usr/NX</code>
We have to first disable password login and only use certificate login. To do this, edit the file <code>vim /usr/NX/etc/server.config</code> and add this line. After this, restart the nx server <code>/usr/NX/bin/nxserver --restart</code>
Verify that password login does not work
For resolution, the key idea is that there should be no x server running already on the machine. If there is no x server, then nx will create its own, and by default try to match the client resolution, which is what we want. Unfortunately, when we install gnome desktop, it automatically changes the systemd runlevel to graphical.target which means systemd will spawn gdm and an xserver /usr/lib/xorg/Xorg (hope you dont get into wayland and shit). So we have to change the default systemd target to shell mode, which can be done by <code>sudo systemctl set-default multi-user.target</code>* 
And thats it, nx should automatically try to match client resolution if client is running in full screen mode!</p>
<p>Sometimes, you will see a black screen when you login, to solve this</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>service<span class="w"> </span>gdm<span class="w"> </span>stop
/usr/NX/bin/nxserver<span class="w"> </span>--restart
</code></pre></div>

<h1><a name="remote-desktop-to-raspberry-pi" href="#remote-desktop-to-raspberry-pi">Remote desktop to raspberry pi</a></h1>
<p>We will use real vnc. From terminal, ssh to raspberry pi. On the pi run
<code>vncserver -geometry 1920x1080</code></p>
<p>From the client, run vncviewer from real vnc and login. You have to do this every time you want to login</p>
<h1><a name="echo-server-with-netcat" href="#echo-server-with-netcat">Echo server with netcat </a></h1>
<p>Server
<code>ncat -e /bin/cat -k  -l 8888 &lt;ip&gt;</code></p>
<p>Client 
<code>telnet ip 8888</code></p>
<h1><a name="mounting-a-disk-on-gcp" href="#mounting-a-disk-on-gcp">Mounting a disk on GCP</a></h1>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>lsblk
sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/mnt/disks/sdb
sudo<span class="w"> </span>cp<span class="w"> </span>/etc/fstab<span class="w"> </span>/etc/fstab.backup
sudo<span class="w"> </span>blkid<span class="w"> </span>/dev/sdb
In<span class="w"> </span>/etc/fstb
<span class="nv">UUID</span><span class="o">=[</span>UUID_VALUE<span class="o">]</span><span class="w"> </span>/mnt/disks/<span class="o">[</span>MNT_DIR<span class="o">]</span><span class="w"> </span>ext4<span class="w"> </span>discard,defaults,nofail<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span>
Sudo<span class="w"> </span>mount<span class="w"> </span>-a<span class="w"> </span>
</code></pre></div>

<h1><a name="describe-type-of-command" href="#describe-type-of-command">Describe type of command</a></h1>
<p><code>type ls</code></p>
<h1><a name="linux-networking" href="#linux-networking">Linux Networking</a></h1>
<ul>
<li>
<p><strong>Netfilter</strong>: linux component which has various hooks for network packet manipulation
The netfilter hooks are exposed through various  userspace programs: notably </p>
</li>
<li>
<p><strong>Iptables</strong> : which is the userspace interface to linux firewall, (firewall here simply means configuring netfilter according to some rules), nat mangling etc </p>
</li>
<li>
<p><strong>Subnetting/CIDR</strong> : CIDR splits 32 bit ipv4 addresses into two parts: left part is network part. Right part is host part. This act is called subnetting. <code>0.0.0.0/24</code> Here 24 means, the network part (left part) is 24 bits. The host part (right part is 32-24 = 8) bits. Usually in large companies different networks are indeed different networks. I.e., we need routing between two subnets. With a single (sub)network, there is no need for routing (works like lan)</p>
</li>
<li><strong>Network interfaces</strong>: on the linux level, they are network devices, with a device driver. They get a packet trhough hard_start_xmit() and they can do whatever they want with it. See this for a good example</li>
<li><strong>Bridge</strong>: when referring to a hardware device it is a connector at L2. i.e., it learns mac addresses and forwards packets from one network to another switch is also essentially the same thing</li>
<li><strong>Linux software bridge device</strong>:  is a software network_interface which acts like a bridge between two other network interfaces</li>
</ul>
<h1><a name="postgres" href="#postgres">Postgres</a></h1>
<p>To create a data directory, first </p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>/path/to/data
chown<span class="w"> </span>postgres<span class="w">  </span>/path/to/data
Sudo<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>/usr/lib/postgresql/11/bin/Initdb<span class="w"> </span>-D<span class="w"> </span>/path/to/data
vim<span class="w"> </span>/etc/postgresql/11/main/postgresql.conf<span class="w"> </span><span class="c1">#and modify the data_dir</span>
</code></pre></div>

<p>To make postgres listen to remote connections in the same file:
<code>listen_addresses = '*'</code></p>
<p><code>vim /etc/postgresql/11/main/pg_hba.conf</code>
Add this line (probably give stronger restrictions)</p>
<div class="highlight"><pre><span></span><code>host    all             all             0.0.0.0/0            md5
</code></pre></div>

<p>Restart postgres. There are several ways. One of these should work:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="n">Sudo</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">postgresql</span><span class="w"> </span><span class="n">restart</span>
<span class="n">Or</span><span class="w"> </span>
<span class="w">    </span><span class="n">pg_ctlcluster</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="n">start</span>
<span class="n">Or</span><span class="w"> </span>
<span class="n">pg_ctl</span><span class="w"> </span><span class="o">-</span><span class="n">D</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">postgres</span><span class="w"> </span><span class="n">start</span>
<span class="n">Or</span>
<span class="w">    </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">pg_ctl</span><span class="w"> </span><span class="o">-</span><span class="n">D</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="n">main</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">logfile</span><span class="w"> </span><span class="n">start</span>
<span class="n">Or</span>
<span class="w">   </span><span class="n">sudo</span><span class="w"> </span><span class="n">systemctl</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="n">postgresql</span><span class="mi">@10</span><span class="o">-</span><span class="n">main</span>
</code></pre></div>

<p>Create users by first logging in </p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>psql
create<span class="w"> </span>user<span class="w"> </span>sharath<span class="w"> </span>with<span class="w"> </span>encrypted<span class="w"> </span>password<span class="w"> </span><span class="s1">&#39;foo&#39;</span><span class="p">;</span>
ALTER<span class="w"> </span>USER<span class="w"> </span>sharath<span class="w"> </span>WITH<span class="w"> </span>SUPERUSER<span class="p">;</span>
create<span class="w"> </span>database<span class="w"> </span>sharath<span class="p">;</span>

<span class="c1">#To enable the logs in /etc/postgresql/11/main/postgresql.conf</span>
<span class="nv">log_destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;csvlog&#39;</span>
<span class="nv">logging_collector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>on
<span class="nv">log_rotation_age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0d
<span class="nv">log_statement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;all&#39;</span>
</code></pre></div>

<p>To view the logs
<code>sudo grep SQLEditor /var/lib/postgresql/12/main/log/* |grep -v pg_catalog | grep -v SHOW | grep -v current_schema</code></p>
<h1><a name="intellij-shortcuts" href="#intellij-shortcuts">Intellij Shortcuts</a></h1>
<ul>
<li>Ctrl+shift+enter to complete statement after code completion. Its pretty magical. </li>
<li>Alt+j to select all instances</li>
<li>Tab after ctrl-space overwrites rather than insert</li>
<li>Ctrl+alt-l to reformat whole file or selections</li>
<li>Ctrl+shift+i to see the definition (code) for the method</li>
<li>F2 to go to next highlighted error</li>
<li>F4 go to definition</li>
<li>Ctrl-f12 to see the file structure</li>
<li>Ctrl+shift+numpad- collapse all</li>
</ul>
<h1><a name="bash-shortcuts" href="#bash-shortcuts">Bash shortcuts</a></h1>
<ul>
<li>Alt-B back one word</li>
<li>Alt-f forward one word</li>
<li>Ctrl-w delete back one word</li>
<li>alt-D delete till end of word</li>
<li>Ctrl-U delete to start of line</li>
<li>Ctrl-k delete to end of line</li>
</ul>
<h1><a name="how-to-setup-a-new-linux-machine" href="#how-to-setup-a-new-linux-machine">How to setup a new linux machine</a></h1>
<p>First, login as root. Here nm&gt; means new machine and local&gt; means laptop</p>
<div class="highlight"><pre><span></span><code>nm&gt;<span class="w"> </span>
adduser<span class="w"> </span>-u<span class="w"> </span><span class="m">1001</span><span class="w"> </span>sharath<span class="p">;</span>
usermod<span class="w"> </span>-aG<span class="w"> </span>sudo<span class="w"> </span>sharath
su<span class="w"> </span>-<span class="w"> </span>sharath
ssh-keygen<span class="w"> </span>-t<span class="w"> </span>rsa<span class="w"> </span>-N<span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span>-f<span class="w"> </span>~/.ssh/id_rsa
&lt;create<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>key&gt;
&lt;copy<span class="w"> </span>your<span class="w"> </span>localhost<span class="w"> </span>id_rsa.pub<span class="w"> </span>into<span class="w"> </span>clipboard&gt;
vim<span class="w"> </span>/home/sharath/.ssh/authorized_keys<span class="w"> </span>
&lt;paste<span class="w"> </span>your<span class="w"> </span>id_rsa.pub<span class="w"> </span>and<span class="w"> </span><span class="nb">exit</span><span class="w"> </span>vim&gt;
chmod<span class="w"> </span><span class="m">644</span><span class="w"> </span>/home/sharath/.ssh/authorized_keys
<span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;sharath ALL=(ALL) NOPASSWD: ALL&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/sudoers.d/sharath
sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">0440</span><span class="w"> </span>/etc/sudoers.d/sharath
</code></pre></div>

<p>IMPROVED (scriptable)</p>
<div class="highlight"><pre><span></span><code>First,<span class="w"> </span>copy<span class="w"> </span>your<span class="w"> </span>public<span class="w"> </span>key<span class="w"> </span>to<span class="w"> </span>tmp<span class="w"> </span>on<span class="w"> </span>nm,<span class="w"> </span>like<span class="w"> </span>so
scp<span class="w"> </span>~/.ssh/id_rsa.pub<span class="w"> </span>root@&lt;new_ip&gt;:/tmp/ak<span class="w"> </span>

Login<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>new<span class="w"> </span>box<span class="w"> </span>as<span class="w"> </span>root<span class="w"> </span>and<span class="w"> </span><span class="k">do</span><span class="w"> </span>the<span class="w"> </span>following
adduser<span class="w"> </span>--disabled-password<span class="w"> </span>--gecos<span class="w"> </span>‘’<span class="w"> </span>sharath
usermod<span class="w"> </span>-aG<span class="w"> </span>sudo<span class="w"> </span>sharath
su<span class="w"> </span>-<span class="w"> </span>sharath
ssh-keygen<span class="w"> </span>-t<span class="w"> </span>rsa<span class="w"> </span>-N<span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span>-f<span class="w"> </span>~/.ssh/id_rsa
<span class="nb">exit</span>
cp<span class="w"> </span>/tmp/ak<span class="w"> </span>/home/sharath/.ssh/authorized_keys
chmod<span class="w"> </span><span class="m">644</span><span class="w"> </span>/home/sharath/.ssh/authorized_keys
<span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;sharath ALL=(ALL) NOPASSWD: ALL&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/sudoers.d/sharath
sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">0440</span><span class="w"> </span>/etc/sudoers.d/sharath
rm<span class="w"> </span>/tmp/ak
</code></pre></div>

<p>Bob should be your uncle</p>
<h1><a name="python-regex-recipes" href="#python-regex-recipes">Python regex recipes </a></h1>
<ul>
<li>\s whitespace</li>
<li>\S non whitespace</li>
<li>\d only digits</li>
<li>\D non digits</li>
<li>\w alphanumeric [a-zA-Z0-9_]</li>
<li>\W non-alphanumeric</li>
<li>\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3} ip regex</li>
</ul>
<p>groups enclose in (), numbered from x.group(1)
named groups like this <code>(?P&lt;name) access with x.group("name")</code></p>
<div class="highlight"><pre><span></span><code><span class="n">r</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">regexStr</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(blue|red)&quot;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">())),</span> <span class="s2">&quot;blue socks and red shoes&quot;</span><span class="p">)</span>
</code></pre></div>

<p>prints <code>4 socks and 3 shoes</code></p>
<p>validate a regex on https://regex101.com/</p>
<h1><a name="vim-one-liners-and-shortcuts" href="#vim-one-liners-and-shortcuts">Vim one liners and shortcuts</a></h1>
<ul>
<li>gd will go to local definition</li>
<li>gD will go to global definition </li>
<li>,c<space> toggle comment</li>
<li><ctrl>]  goes to a tag</li>
<li><ctrl>o (“old” comes back from a jump)</li>
<li><ctrl> i (opposite of <ctrl>o</li>
<li>Split window ctrl-w v or o</li>
<li>Scroll up/down, keeping your cursor in its row</li>
<li>One line</li>
<li>Ctrl+Y → Move viewport down</li>
<li>Ctrl+E → Move viewport up (Extra lines)</li>
<li>Column select <ctrl>v </li>
<li>Go to beginning of function (go to { in first column: needs coding convention) [[ </li>
<li>End of function ]]</li>
<li>Beginning of code block: [{ this one should work better with messed up coding convention</li>
</ul>
<h1><a name="cscope-for-linux" href="#cscope-for-linux">Cscope for linux </a></h1>
<p>To apply debian patches use </p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">LNX</span><span class="o">=</span>/home/sharath/os/linux/linux-5.4.0
quilt<span class="w"> </span>push<span class="w"> </span>-a<span class="w"> </span>
find<span class="w">  </span><span class="nv">$LNX</span><span class="w">  </span>-path<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LNX</span><span class="s2">/arch/*&quot;</span><span class="w"> </span>!<span class="w"> </span>-path<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LNX</span><span class="s2">/arch/x86*&quot;</span><span class="w"> </span>-prune<span class="w"> </span>-o<span class="w">  </span>-path<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LNX</span><span class="s2">/include/asm-*&quot;</span><span class="w"> </span>!<span class="w"> </span>-path<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LNX</span><span class="s2">/include/asm-i386*&quot;</span><span class="w"> </span>-prune<span class="w"> </span>-o<span class="w">  </span>-path<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LNX</span><span class="s2">/tmp*&quot;</span><span class="w"> </span>-prune<span class="w">  </span>-path<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LNX</span><span class="s2">/Documentation*&quot;</span><span class="w"> </span>-prune<span class="w"> </span>-o<span class="w">  </span>-path<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LNX</span><span class="s2">/scripts*&quot;</span><span class="w"> </span>-prune<span class="w"> </span>-o<span class="w">    </span>-path<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LNX</span><span class="s2">/drivers*&quot;</span><span class="w"> </span>-prune<span class="w"> </span>-o<span class="w">   </span>-path<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LNX</span><span class="s2">/.pc/*&quot;</span><span class="w"> </span>-prune<span class="w"> </span>-o<span class="w">  </span>-path<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LNX</span><span class="s2">/debian/*&quot;</span><span class="w"> </span>-prune<span class="w"> </span>-o<span class="w">   </span>-path<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LNX</span><span class="s2">/sound/*&quot;</span><span class="w"> </span>-prune<span class="w"> </span>-o<span class="w">    </span>-name<span class="w"> </span><span class="s2">&quot;*.[chxsS]&quot;</span><span class="w"> </span>-print<span class="w"> </span>&gt;<span class="w"> </span>kernel.cscope

cscope<span class="w"> </span>-q<span class="w"> </span>-R<span class="w"> </span>-b<span class="w"> </span>-i<span class="w"> </span>cscope.files
</code></pre></div>

<p>In vim</p>
<div class="highlight"><pre><span></span><code>:cs f g &lt;foo&gt; goto definition of foo
:cs f s &lt;foo&gt; find this symbol
:cs f t &lt;foo&gt; find this string
&lt;ctrl&gt;\ s on a word, find this symbol and so on
</code></pre></div>

<h1><a name="cscope-for-ceph" href="#cscope-for-ceph">Cscope for ceph</a></h1>
<div class="highlight"><pre><span></span><code>find<span class="w"> </span>/mnt/disks/sdb/ceph-pristine<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-and<span class="w"> </span><span class="se">\(</span><span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.c&quot;</span><span class="w"> </span>-o<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.h&quot;</span><span class="w"> </span>-o<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.cc&quot;</span><span class="w"> </span>-o<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.cpp&quot;</span><span class="w"> </span>-o<span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.hh&quot;</span><span class="w"> </span><span class="se">\)</span><span class="w"> </span>&gt;<span class="w"> </span>zoo.cscope
cscope<span class="w"> </span>-q<span class="w"> </span>-R<span class="w"> </span>-b<span class="w"> </span>-i<span class="w"> </span>zoo.cscope<span class="w"> </span>
</code></pre></div>

<h1><a name="building-linux" href="#building-linux">Building linux</a></h1>
<p>You can get the linux source from 
<code>apt-get source linux-image-unsigned-$(uname -r)</code></p>
<p>You can get the config file from 
<code>cp /boot/config-5.4.0-26-generic .config</code>
To install dependencies</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>libncurses-dev<span class="w"> </span>flex<span class="w"> </span>bison<span class="w"> </span>openssl<span class="w"> </span>libssl-dev<span class="w"> </span>dkms<span class="w"> </span>libelf-dev<span class="w"> </span>libudev-dev<span class="w"> </span>libpci-dev<span class="w"> </span>libiberty-dev<span class="w"> </span>autoconf
sudo<span class="w"> </span>apt-get<span class="w"> </span>build-dep<span class="w"> </span>linux<span class="w"> </span>linux-image-<span class="k">$(</span>uname<span class="w"> </span>-r<span class="k">)</span>

make<span class="w"> </span><span class="nv">ARCH</span><span class="o">=</span>x86<span class="w"> </span><span class="nv">EXTRAVERSION</span><span class="o">=</span>-SS<span class="w"> </span>-j14<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>-j14<span class="w"> </span><span class="nv">ARCH</span><span class="o">=</span>x86<span class="w"> </span><span class="nv">EXTRAVERSION</span><span class="o">=</span>-SS<span class="w"> </span>install<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>-j14<span class="w"> </span><span class="nv">ARCH</span><span class="o">=</span>x86<span class="w"> </span><span class="nv">EXTRAVERSION</span><span class="o">=</span>-SS<span class="w"> </span>modules_install<span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;------------------------- DONE --------------------------------&quot;</span>
rm<span class="w"> </span>/boot/initrd.img-3.16.43-SS
update-initramfs<span class="w"> </span>-c<span class="w"> </span>-k<span class="w"> </span><span class="m">3</span>.16.43-SS
update-grub
</code></pre></div>

<h1><a name="using-ftrace-to-trace-linux-functions" href="#using-ftrace-to-trace-linux-functions">Using Ftrace to trace linux functions</a></h1>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w">  </span>/sys/kernel/debug/tracing/tracing_on
And<span class="w"> </span><span class="k">then</span><span class="w"> </span>use<span class="w"> </span>brendan<span class="w"> </span>greggs<span class="w"> </span>perf-tools
sudo<span class="w"> </span>./funcgraph<span class="w"> </span>-D<span class="w">  </span>ext4_readpages<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/mnt/tmpfs/write
sudo<span class="w"> </span>./funcgraph<span class="w"> </span>-Dp<span class="w"> </span><span class="m">51985</span><span class="w">  </span>ext4_readpages<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/mnt/tmpfs/write
</code></pre></div>

<h1><a name="how-to-build-linux-on-one-machine-and-deploy-on-another" href="#how-to-build-linux-on-one-machine-and-deploy-on-another">How to build linux on one machine and deploy on another</a></h1>
<p>Use “building linux” to build linux on one machine A. Suppose you want to install it on machine B
On machine B</p>
<div class="highlight"><pre><span></span><code>Mkdir<span class="w"> </span>-p<span class="w"> </span>~/kernel/boot
Mkdir<span class="w"> </span>-p<span class="w"> </span>~/kernel/modules
</code></pre></div>

<p>On machine A</p>
<div class="highlight"><pre><span></span><code>tar<span class="w"> </span>-cvzf<span class="w"> </span>~/modules<span class="w"> </span>/lib/modules/3.16.43-SS
scp<span class="w"> </span>-r<span class="w"> </span>*SS*<span class="w"> </span>&lt;B&gt;:~/kernel/boot
scp<span class="w"> </span>~/modules<span class="w"> </span>&lt;B&gt;:~/kernel/modules/
</code></pre></div>

<p>On machine B:</p>
<div class="highlight"><pre><span></span><code>Cd<span class="w"> </span>~/kernel/modules
tar<span class="w"> </span>-xvzf<span class="w"> </span>modules
sudo<span class="w"> </span>mv<span class="w"> </span>~/kernel/modules/3.16.43-SS<span class="w"> </span>/lib/modules/
sudo<span class="w"> </span>cp<span class="w"> </span>~/kernel/boot/*<span class="w"> </span>/boot/
sudo<span class="w"> </span>rm<span class="w"> </span>/boot/initrd.img-3.16.43-SS
sudo<span class="w"> </span>update-initramfs<span class="w"> </span>-c<span class="w"> </span>-k<span class="w"> </span><span class="m">3</span>.16.43-SS
sudo<span class="w"> </span>update-grub


<span class="c1">#And… reboot!</span>
Sudo<span class="w"> </span>reboot<span class="w"> </span>now
</code></pre></div>

<h1><a name="jemalloc" href="#jemalloc">JeMalloc </a></h1>
<p>Do a git clone.</p>
<div class="highlight"><pre><span></span><code>./autogen.sh<span class="w"> </span>
./configure<span class="w"> </span>--enable-prof<span class="w"> </span>--enable-stats<span class="w"> </span>--enable-debug
Make


<span class="o">[</span>sharath.g@osboxes<span class="w"> </span>/home/sharath.g/code/jemalloc<span class="o">]</span>$<span class="w"> </span>tree<span class="w"> </span>lib<span class="w"> </span>
lib
├──<span class="w"> </span>libjemalloc.a
├──<span class="w"> </span>libjemalloc_pic.a
├──<span class="w"> </span>libjemalloc.so<span class="w"> </span>-&gt;<span class="w"> </span>libjemalloc.so.2
└──<span class="w"> </span>libjemalloc.so.2

<span class="c1">#To generate the profile:</span>
<span class="o">(</span>reverse-i-search<span class="o">)</span><span class="sb">`</span>java<span class="s1">&#39;: rm jeprof*; rm /tmp/prof.gif; MALLOC_CONF=prof:true,lg_prof_sample:0,lg_prof_interval:25 LD_PRELOAD=${JEMALLOC_PATH}/lib/libjemalloc.so.2 java -Xmx1096m -cp  &#39;</span>/home/sharath.g/diskbench/:/home/sharath.g/diskbench/*<span class="err">&#39;</span><span class="w"> </span>sha.Memory<span class="p">;</span><span class="w"> </span>ls<span class="w"> </span>jeprof*<span class="p">;</span><span class="w"> </span>~/code/jemalloc/bin/jeprof<span class="w"> </span>--show_bytes<span class="w"> </span>--gif<span class="w"> </span><span class="sb">`</span>which<span class="w"> </span>java<span class="sb">`</span><span class="w"> </span>jeprof*.heap<span class="w"> </span>&gt;<span class="w"> </span>/tmp/prof.gif<span class="w"> </span>
</code></pre></div>

<p>If you’ve compiled jemalloc on some other machine and copied it to this machine, youget teh error Can't exec "objdump": No such file or directory at /home/sharath.g/jemalloc/bin/jeprof line 4459.
Then objdump is 
Jemalloc what is active, dirty (unused), resident, total memory, allocated, mapped?
Allocated = sum of all malloc arguments that has not been freed 
Active .. multiple of page size.. Total bytes in pages that have at least one byte of allocated memory
Resident: active + metadata 
Mapped: multiple of chunk size. Total chunks that have one byte of allocated 
See that man pages for a clear explanation.</p>
<h1><a name="objdump" href="#objdump">Objdump</a></h1>
<div class="highlight"><pre><span></span><code>objdump<span class="w"> </span>-drSt<span class="w"> </span>hello.o
-d<span class="w"> </span>dissasemble
-r<span class="w"> </span>show<span class="w"> </span>relocation<span class="w"> </span>info<span class="w"> </span>inline
-S<span class="w"> </span>show<span class="w"> </span>C<span class="w"> </span><span class="nb">source</span><span class="w"> </span>code
-t<span class="w"> </span>show<span class="w"> </span>symbol<span class="w"> </span>table
</code></pre></div>

<h1><a name="installing-latest-version-of-cmake" href="#installing-latest-version-of-cmake">Installing latest version of cmake</a></h1>
<p>Either apt-get install cmake or get it from here
https://cmake.org/download/
https://cmake.org/files/v3.8/cmake-3.8.0-rc4-Linux-x86_64.sh and run it</p>
<h1><a name="getting-honest-profiler-to-work" href="#getting-honest-profiler-to-work">Getting honest profiler to work</a></h1>
<p>Installing it: 
If you’re lucky, you can download it and it works http://insightfullogic.com/honest-profiler.zip</p>
<p>Otherwise you need to build it. To build it, if you get weird errors, you might need to get latest version of Cmake, and then build it. You need build/libagent.so</p>
<p>Start the java program with     <br>
<code>-agentpath:$HONEST_PROFILER_HOME/liblagent.so=host=localhost,port=4242,logPath=/grid/1/log/hadoop-yarn/yarn/honest-profiler.hpl</code></p>
<p>Start and stop profiling with </p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>start<span class="w"> </span><span class="p">|</span><span class="w"> </span>nc<span class="w"> </span>localhost<span class="w"> </span><span class="m">4242</span>
<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>stop<span class="w"> </span><span class="p">|</span><span class="w"> </span>nc<span class="w"> </span>localhost<span class="w"> </span><span class="m">4242</span>
</code></pre></div>

<p>Collapse the stacks with <code>java -cp $HONEST_PROFILER_HOME/honest-profiler.jar com.insightfullogic.honest_profiler.ports.console.FlameGraphDumperApplication netty.hpl netty.cstk</code></p>
<h1><a name="gcc-important-options" href="#gcc-important-options">GCC important options</a></h1>
<p>The linker <code>ld</code> takes as input .c files, .o files, .so files and can output an executable or a shared library.
The linker does not output static library. You can simply use ar for it</p>
<p>Gcc important options
-l mylib 
Look for a library called libmylib.{a, so}
But if both are present, will it choose .a or .so (it chooses .so) if you want to link an .a file, specify it directly on the command line. Or specify -static so it will choose .a even for libc </p>
<p>Which directories to look in ?
-L dir is the answer</p>
<p>-i dir is for searching include files 
-include file
Is as if file was #included in source code in the first line. </p>
<p>So basically <code>-L dir -l mylib -I dir -include files</code></p>
<p>When creating an executable:
You cannot link a shared library statically by giving it on the command line (to create an executable) even if you give on command line, it still links it as  a shared library (as if you had given -L. -lxxx)
Or you cannot link a static library in a shared way by using -L and -l options (to create an executable)(you can but it will be taken as static, even if the static library is named libxx.so) </p>
<p>Static libraries can be linked (statically) by specifying them as input files to gcc. Remember: static libraries are just a bunch of .o files 
You cannot skip specifying a shared library while linking to create an executable (although, technically they are not needed)  all variables must be resolved, which means that all shared libraries have to be specified (strictly not required, i guess its a sanity check) this has the effect of  listing in the executable as a dependency     </p>
<p>For <code>LD_PRELOAD</code> to work, you have to specify -Wl,-soname,libml.so while having created that shared library this name is hardcoded into the so as its name, and this is the name that the linker looks at while loading the executable, not the file name of the .so</p>
<h1><a name="when-creating-a-shared-library:" href="#when-creating-a-shared-library:">When creating a shared library:</a></h1>
<p>All object files must be compiled with -fpic
All ar files must have .o files which have been compiled with -fpic
If you specify multiple .so on command line, they will be combined into 1 .so as expected, with references resolved internally 
If a dependency is unmet (by not specifying some libraries at all) it is defined as undefined but linking succeeds
If a dependency is met by -L. -lxxx then it is undefined in the .so but that lib is listed as a dependency</p>
<h1><a name="eli-bendersky-static-linking-summary" href="#eli-bendersky-static-linking-summary">Eli bendersky static linking summary</a></h1>
<p>Static linking algorithm perfectly explained in http://eli.thegreenplace.net/2013/07/09/library-order-in-static-linking
Some important points
* An object file both exports and imports symbols 
* individual object files specified on cmd line are always linked
* static libraries (ar) libraries serve only to provide a list of object files, and an object file in a library is linked only if it satisfies some current unmet dependency </p>
<h1><a name="eli-bendersky-load-time-linking-summary" href="#eli-bendersky-load-time-linking-summary">Eli bendersky load time linking summary</a></h1>
<p>Summary of load time linking as specified in http://eli.thegreenplace.net/2011/08/25/load-time-relocation-of-shared-libraries</p>
<p>Some gotchas: 
* Call operands are rip relative, but mov operands are absolute. In x86_64, there is a new addressing called RIP relative where any operand can be RIP relative.
* If a shared variable in a .so is referenced from the main executable, then that shared variable will go into the main executable, since the main executable is not relocatable. 
* what about a shared function in a .so referenced from main executable? The article does not mention it, but i imagine the functionality is similar. I.e. put the address of the function in the main program during load time and then call it.</p>
<p>Basically the address where a shared library is loaded is unknown
The static linker generates .so as if the shared library is loaded at 0x0 (logical)
The linker tells the offset of each variable in the file. 
The loader will add this offset to the load address to get the real address
The linker also populates a list where the real address has to be patched into the code. 
The loader will then patch the addresses in
Thats it.</p>
<h1><a name="eli-bendersky-x32-pic-linking-summary" href="#eli-bendersky-x32-pic-linking-summary">Eli bendersky x32 PIC linking summary</a></h1>
<p>http://eli.thegreenplace.net/2011/11/03/position-independent-code-pic-in-shared-libraries</p>
<p>Instead of direct patching in the code, the real addresses of shared variables are stored in a GOT table in the data section. 
For mov operands, x32 does not support rip relative addresses, so there is a hack to get current rip address, then add the offset of the got table, and thus get the address of the variable</p>
<p>For call instructions, they are still using the hack but call supports rip relative addressing. So not sure what is happening,</p>
<h1><a name="linux-interrupt-handling" href="#linux-interrupt-handling">Linux Interrupt Handling</a></h1>
<p>Peripheral devices pass interrupt to the interrupt controller (8259) which then passes it to processor on a given interrupt line.
An Interrupt line can be shared by multiple devices. To detect which device raised the interrupt, the linux interrupt handler iterates through all registered handlers on that line which then checks if that device raised the interrupt.
When an interrupt is raised, the processor disables all interrupts (on the local processor). 
The linux handler reenables interrupts (unless a flag was set while registering the handler) but disables the interrupt line (so none of the devices sharing can raise another interrupt) and calls the handler. For this reason, an interrupt handler need not be re-entrant. 
An interrupt handler cannot sleep/block because there is no “process” to sleep or block. (theoretically, the process can be considered to be the process that was interrupted but seems like a design decision to not let interrupt handlers sleep or not associate interrupt handlers with a process.</p>
<h1><a name="hdfs-proxy-user-setting" href="#hdfs-proxy-user-setting">HDFS proxy user setting</a></h1>
<p>In addition to the modifications in core-site.xml we need to create the user and (add it to a group (?)) on the namenode. Even this is not working. It looks like the user needs to be added on the datanodes too. Is this true?
The logs from namenode are like this: </p>
<div class="highlight"><pre><span></span><code>2017-06-05 11:48:27,271 INFO  ipc.Server (Server.java:doRead(850)) - Socket Reader #1 for port 8020: readAndProcess from client 10.32.10.3 threw exception [org.apache.hadoop.security.authorize.AuthorizationException: Unauthorized connection for super-user: hue from IP 10.32.10.3]
The ip 10.32.10.3 is a datanode.
</code></pre></div>

<h1><a name="http-proxy-with-squid" href="#http-proxy-with-squid">Http proxy with squid</a></h1>
<h3>On the client machine</h3>
<ul>
<li>Find out the client subnet of the form <code>10.34.44.0/22</code>. To do that, on the client machine, run <code>/sbin/ifconfig</code> to find out the       ip address and subnet mask. with these two pieces of info, you can calculate the CIDR <a href="http://www.subnet-calculator.com/cidr.php">here</a></li>
<li>export variables: 
  <code>text
  export http_proxy=http://client.ip.ad.ress:port/
  export https_proxy=http://client.ip.ad.ress:port/</code></li>
</ul>
<h3>Caveat</h3>
<p>if you run sudo, make sure the variables are exported in root</p>
<h3>On the proxy machine</h3>
<ul>
<li>Install squid: <code>sudo apt-get install squid</code>. </li>
<li>
<p>change /etc/squid/squid.conf to add these lines
   <code>text
   acl wormhole src 10.34.44.0/22 # the client subnet who need the proxy
   http_access allow wormhole # wormhole is just a name
   icp_access allow wormhole</code></p>
</li>
<li>
<p>restart squid <code>sudo /etc/squid/squid.conf restart</code></p>
</li>
</ul>
<p>And thats it! <code>curl -L www.google.com</code> (<code>-L</code> to follow redirects) will work.</p>
<p>I needed this for <code>pip</code>. With my setup, I can do <code>sudo export &lt;blah&gt;;export&lt;blah&gt;;pip install &lt;package&gt;</code>. </p>
<p>FYI, my squid version is</p>
<div class="highlight"><pre><span></span><code>[sharath.g@d42-a-0003 /home/sharath.g]$ dpkg -s squid
Package: squid
Status: install ok installed
Priority: optional
Section: web
Installed-Size: 1864
Maintainer: Luigi Gangitano &lt;luigi@debian.org&gt;
Architecture: amd64
Version: 2.7.STABLE9-4.1+deb7u1
Replaces: squid-novm
Depends: libc6 (&gt;= 2.7), libcomerr2 (&gt;= 1.01), libdb5.1, libgssapi-krb5-2 (&gt;= 1.10+dfsg~), libkrb5-3 (&gt;= 1.6.dfsg.2), libldap-2.4-2 (&gt;= 2.4.7), libpam0g (&gt;= 0.99.7.1), netbase, adduser, logrotate (&gt;= 3.5.4-1), squid-common (&gt;= 2.7.STABLE9-4.1+deb7u1), lsb-base (&gt;= 3.2-14), perl-modules
Pre-Depends: debconf (&gt;= 1.2.9) | debconf-2.0
Suggests: squidclient, squid-cgi, logcheck-database, resolvconf (&gt;= 0.40), smbclient, winbind
Conflicts: sarg (&lt;&lt; 1.1.1-2), squid-novm
Conffiles:
 /etc/init.d/squid 04af7c1f2d27c35db0200679fbc9bdbe
 /etc/logrotate.d/squid 0dd1fea0f842a58f538408754e747311
 /etc/resolvconf/update-libc.d/squid f8d0ffa84ddd982f32da05cb61bc479e
Description: Internet object cache (WWW proxy cache)
 This package provides the Squid Internet Object Cache developed by
 the National Laboratory for Applied Networking Research (NLANR) and
 Internet volunteers.
Homepage: http://www.squid-cache.org/
</code></pre></div>

<h1><a name="kafka-metrics" href="#kafka-metrics">kafka metrics</a></h1>
<p><strong>Bytes in</strong> is number of bytes from external producers only. It does not include, for example, the bytes read by followers during replication. So <code>bytes_in = message_produce_rate * average_message_size</code></p>
<p><strong>Bytes out</strong> includes data sent to follower also.</p>

    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="/theme/blog.js"></script>

  </body>
</html>



